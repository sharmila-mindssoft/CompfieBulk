{% extends "files/client/common/html/container.html" %}
{% block content %}
<link href="/files/client/common/css/dashboard.css" rel="stylesheet" type="text/css" />
<link href="/files/client/common/css/multiselect/bootstrap-multiselect.css" rel="stylesheet" type="text/css" />

<script type="text/javascript">
  $(function(){
    $(".left-menu-button").show();
    $(".content-page").removeClass('m-l-0');
  });
</script>


<div class="left side-menu">
  <div class="sidebar-inner slimscrollleft">
    <div id="sidebar-menu">
      <ul>
        <li class="text-muted menu-title">Chart List</li>
        <li class="has_sub"> <a href="/dashboard" class="waves-effect"><i class="zmdi zmdi-info-outline"></i> <span> Compliance Status </span> </a> </li>
        <li class="has_sub"> <a href="/dashboard/escalation" class="waves-effect"><i class="zmdi zmdi-case"></i> <span> Escalation </span> </a> </li>
        <li class="has_sub active"> <a href="/dashboard/not-complied" class="waves-effect"><i class="zmdi zmdi-block"></i> <span> Not Complied </span> </a> </li>
        <li class="has_sub"> <a href="/dashboard/assignee-wise" class="waves-effect"><i class="zmdi zmdi-card-travel"></i> <span> Assignee Wise Compliance</span> </a> </li>
        <li class="has_sub"> <a href="/dashboard/trend-chart" class="waves-effect"><i class="zmdi zmdi-chart"></i> <span> Trend Chart </span> </a> </li>
        <li class="has_sub"> <a href="/dashboard/compliance-applicability" class="waves-effect"><i class="zmdi zmdi-chart"></i> <span> Compliance Applicability </span> </a> </li>
        <li class="has_sub"> <a href="/dashboard/risk-chart" class="waves-effect"><i class="zmdi zmdi-chart"></i> <span> Risk Chart </span> </a> </li>
      </ul>
      <div class="clearfix"></div>
    </div>
    <div class="clearfix"></div>
  </div>
</div>



<div class="content-page">
  <div class="content">
    <div class="container">
      <!-- Page-Title -->
      <div class="row">
        <div class="col-sm-12 h4-title">
          <h4 class="page-title pull-left">Not complied</h4>
		  <div class="pull-right">
			  <a href="javascript:void(0);" class="right-bar-toggle dropdown-toggle card-drop btn btn-info" title="Filter">
					<i class="zmdi zmdi-sort"></i> <small>Filter</small>
               </a>
			</div>
        </div>
      </div>
      <div class="row">
        <div class="col-lg-12"> 
          <div id="level-filter" class="card-box">
            <input type="hidden" id="hidden"/>           
            <div class="graph-box">
        <input type="button" id="viewaspie" class="btn btn-primary pull-right" value="View as pie chart"/>
        <input type="button" id="viewasbar" class="btn btn-primary pull-right m-r-10" value="View as bar chart"/>
        <input type="button" id="back"  onClick="loadGroup()" class="btn btn-primary pull-right m-r-10" value="Back"/>
        <p id="year-para" >
          <span >Select Year:</span><select id="year" multiple="multiple" placeholder="Select Years" onchange="console.log($(this).children(':selected').length)" class="testSelAll2 input-box sumo2" >
            <option value="2009" >2009</option>
            <option value="2010" >2010</option>
            <option value="2011" >2011</option>
            <option value="2012" >2012</option>
            <option value="2013" selected>2013</option>
            <option value="2014" selected>2014</option>
            <option value="2015" selected>2015</option>
          </select>
        </p>
        <div class="clearfix"></div>
        <div id="container" ></div>
        <input type="button" id="previous" class="btn btn-primary" value="<< Previous"/>
        <input type="button" id="next" class="btn btn-primary pull-right" value="Next >>"/>
      </div>
          </div>
        </div>
      </div>
    </div>
    <!-- content -->
  </div>
</div>
<div class="side-bar right-bar"> <a href="javascript:void(0);" class="right-bar-toggle close-button"> <i class="zmdi zmdi-close-circle-o"></i> </a>
  <h4 class="filter-text">Filter By</h4>
  <div class="notification-list nicescroll">
    <div class="form-group col-sm-12">
      <label class="control-label">Country</label>
    <div class="pull-right">
      <select class="form-control input-sm" id="country" multiple="multiple">
        <option selected="selected">India</option>
        <option selected="selected">US</option>
        <option selected="selected">Malaysia</option>
        <option selected="selected">Singapore</option>
        <option selected="selected">China</option>
      </select>
    </div>
    </div>
    <div class="form-group col-sm-12">
      <label class="control-label">Domain</label>
    <div class="pull-right">
      <select class="form-control input-sm pull-right" id="domain" multiple="multiple">
        <option selected="selected">Finance Law</option>
        <option selected="selected">Labour Law</option>
        <option selected="selected">Industrial Law</option>
      </select>
    </div>
    </div>
    <div class="form-group col-sm-12 no-margin">
      <div class="checkbox checkbox-primary no-bottom-margin ">
        <input id="radioGroup" type="checkbox" checked="checked">
        <label for="radioGroup"> Group </label>
      </div>
    </div>
    <div class="form-group col-sm-12 no-margin ">
      <div class="checkbox checkbox-primary no-bottom-margin ">
        <input id="radioBusinessGroup" type="checkbox">
        <label for="radioBusinessGroup"> Business Group </label>
      </div>
      <div class="has-feedback textboxbusiness" id="filter-business-group">
        <input type="text" class="form-control input-sm pull-right" value="KG">
        <i class="fa-1-2x form-control-feedback fa fa-search"></i>
      </div>
    </div>
    <div class="form-group col-sm-12 no-margin">
      <div class="checkbox checkbox-primary no-bottom-margin ">
        <input id="radioLegalEntity" type="checkbox">
        <label for="radioLegalEntity"> Legal Entity </label>
      </div>
      <div class="has-feedback textboxlegalentity" id="filter-legal-entity">
        <input type="text" class="form-control input-sm pull-right" value="RG Legal Entity 1">
        <i class="fa-1-2x form-control-feedback fa fa-search"></i>
      </div>
    </div>
    <div class="form-group col-sm-12 no-margin">
      <div class="checkbox checkbox-primary no-bottom-margin ">
        <input id="radioDivision" type="checkbox">
        <label for="radioDivision"> Division </label>
      </div>
      <div class="has-feedback textboxdivision" id="filter-division">
        <input type="text" class="form-control input-sm pull-right" value="KG Manufacturing Division">
        <i class="fa-1-2x form-control-feedback fa fa-search"></i>
      </div>
    </div>
    <div class="form-group col-sm-12 no-margin">
      <div class="checkbox checkbox-primary no-bottom-margin ">
        <input id="radiocategorys" type="checkbox">
        <label for="radiocategorys"> Category </label>
      </div>
      <div class="has-feedback textboxcategory" id="filter-category">
        <input type="text" class="form-control input-sm pull-right" value="KG Category 1">
        <i class="fa-1-2x form-control-feedback fa fa-search"></i>
      </div>
    </div>
    <div class="form-group col-sm-12 no-margin">
      <div class="checkbox checkbox-primary no-bottom-margin ">
        <input id="radioUnit" type="checkbox">
        <label for="radioUnit"> Unit </label>
      </div>
      <div class="has-feedback textboxunit" id="filter-unit">
        <input type="text" class="form-control input-sm pull-right" value="Branch Office - 1">
        <i class="fa-1-2x form-control-feedback fa fa-search"></i>
      </div>
    </div>
    <div class="form-group col-sm-12">
      <div class="checkbox checkbox-primary">
        <input id="radioConsolidated" type="checkbox">
        <label for="radioConsolidated"> Consolidated </label>
      </div>
    </div>
    <div class="form-group col-sm-12">
      <button class="btn btn-primary" id="go">Go</button>
    </div>
  </div>
</div>
<script type="text/javascript" src="/files/client/common/js/charts/html5.js"></script>
<script type="text/javascript" src="/files/client/common/js/charts/highcharts.js"></script>
<script type="text/javascript" src="/files/client/common/js/charts/highcharts-3d.js"></script>
<script type="text/javascript" src="/files/client/common/js/charts/exporting.js"></script>
<script type="text/javascript" src="/files/client/common/js/charts/standalone-framework.js"></script>
<script src="/files/client/common/js/multiselect/bootstrap-multiselect.js"></script>
<script type="text/javascript">
    $('#country').multiselect();
    $('#domain').multiselect();	
</script>


<script type="text/javascript">
    $(document).ready(function() {
      $("#year-para").hide();
      $(".dropdown-box-container").click(function() {
        $(".filter-dropdown-container").slideToggle();
      })
      //window.testSelAll2 = $('.testSelAll2').SumoSelect({selectAll:false });
    })

        $(document).ready(function () {
            $(".textboxdomain").show();
            $(".textboxgroup").hide();
            $(".textboxlegalentity").hide();
            $(".textboxdivision").hide();
            $(".textboxcategory").hide();
            $(".textboxunit").hide();
            $(".textboxbusiness").hide();

            $("#radioGroup").click(function() {
                $(".textboxbusiness").hide();
                $(".textboxlegalentity").hide();
                $(".textboxdivision").hide();
                $(".textboxcategory").hide();
                $(".textboxunit").hide();

                $("#previousyear").show();
                $("#nextyear").show();

                $("#radioGroup").prop("checked", true);
                $("#radioBusinessGroup").prop("checked", false);
                $("#radioLegalEntity").prop("checked", false);
                $("#radioDivision").prop("checked", false);
                $("#radiocategorys").prop("checked", false);
                $("#radioUnit").prop("checked", false);
                $("#radioConsolidate").prop("checked", false);
                $("#radioConsolidated").prop("checked", false);

                loadEscalations();
            });
            $("#radioBusinessGroup").click(function() {
                $(".textboxbusiness").show();
                $(".textboxlegalentity").hide();
                $(".textboxdivision").hide();
                $(".textboxcategory").hide();
                $(".textboxunit").hide();

                $("#previousyear").show();
                $("#nextyear").show();

                $("#radioGroup").prop("checked", false);
                $("#radioBusinessGroup").prop("checked", true);
                $("#radioLegalEntity").prop("checked", false);
                $("#radioDivision").prop("checked", false);
                $("#radiocategorys").prop("checked", false);
                $("#radioUnit").prop("checked", false);
                $("#radioConsolidate").prop("checked", false);
                $("#radioConsolidated").prop("checked", false);

                loadEscalationsBusinessGroup();
            });
            $("#radioLegalEntity").click(function() {
                $(".textboxbusiness").hide();
                $(".textboxlegalentity").show();
                $(".textboxdivision").hide();
                $(".textboxcategory").hide();
                $(".textboxunit").hide();

                $("#previousyear").show();
                $("#nextyear").show();

                $("#radioGroup").prop("checked", false);
                $("#radioBusinessGroup").prop("checked", false);
                $("#radioLegalEntity").prop("checked", true);
                $("#radioDivision").prop("checked", false);
                $("#radiocategorys").prop("checked", false);
                $("#radioUnit").prop("checked", false);
                $("#radioConsolidate").prop("checked", false);
                $("#radioConsolidated").prop("checked", false);

                loadEscalationsLegalEntity();
            });
            $("#radioDivision").click(function() {
                $(".textboxbusiness").hide();
                $(".textboxlegalentity").hide();
                $(".textboxdivision").show();
                $(".textboxcategory").hide();
                $(".textboxunit").hide();

                $("#previousyear").show();
                $("#nextyear").show();

                $("#radioGroup").prop("checked", false);
                $("#radioBusinessGroup").prop("checked", false);
                $("#radioLegalEntity").prop("checked", false);
                $("#radioDivision").prop("checked", true);
                $("#radiocategorys").prop("checked", false);
                $("#radioUnit").prop("checked", false);
                $("#radioConsolidate").prop("checked", false);
                $("#radioConsolidated").prop("checked", false);

                loadEscalations();
            });
            $("#radiocategorys").click(function() {
                $(".textboxbusiness").hide();
                $(".textboxlegalentity").hide();
                $(".textboxdivision").hide();
                $(".textboxcategory").show();
                $(".textboxunit").hide();

                $("#previousyear").show();
                $("#nextyear").show();
                
                $("#radioGroup").prop("checked", false);
                $("#radioBusinessGroup").prop("checked", false);
                $("#radioLegalEntity").prop("checked", false);
                $("#radioDivision").prop("checked", false);
                $("#radiocategorys").prop("checked", true);
                $("#radioUnit").prop("checked", false);
                $("#radioConsolidate").prop("checked", false);
                $("#radioConsolidated").prop("checked", false);

                loadEscalationsBusinessGroup();
            });
            $("#radioUnit").click(function() {
                $(".textboxgroup").hide();
                $(".textboxlegalentity").hide();
                $(".textboxdivision").hide();
                $(".textboxcategory").hide();
                $(".textboxunit").show();
                $(".textboxbusiness").hide();

                $("#previousyear").show();
                $("#nextyear").show();
                
                $("#radioGroup").prop("checked", false);
                $("#radioBusinessGroup").prop("checked", false);
                $("#radioLegalEntity").prop("checked", false);
                $("#radioDivision").prop("checked", false);
                $("#radiocategorys").prop("checked", false);
                $("#radioUnit").prop("checked", true);
                $("#radioConsolidate").prop("checked", false);
                $("#radioConsolidated").prop("checked", false);

                loadEscalations();
            });
            $("#radioConsolidated").click(function() {
                $(".textboxgroup").hide();
                $(".textboxlegalentity").hide();
                $(".textboxdivision").hide();
                $(".textboxcategory").hide();
                $(".textboxunit").hide();
                $(".textboxbusiness").hide();

                $("#previousyear").hide();
                $("#nextyear").hide();

                $("#radioGroup").prop("checked", false);
                $("#radioBusinessGroup").prop("checked", false);
                $("#radioLegalEntity").prop("checked", false);
                $("#radioDivision").prop("checked", false);
                $("#radiocategorys").prop("checked", false);
                $("#radioUnit").prop("checked", false);
                $("#radioConsolidate").prop("checked", true);

                loadEscalationsLegalEntity();
            });
        });

    $(document).ready(function() {
      loadEscalations();
      $("#viewaspie").hide();

      $("#previous").click(function() {
          
       })

      $("#next").click(function() {
          
       })

      $("#viewaspie").click(function() {
              loadEscalations();
       })

      $("#viewasbar").click(function() {
              loadEscalationsBar();
       })

      $("#back").click(function() {
              loadEscalations();
       })

      $("#go-le").click(function() {
              loadEscalations();
       })

      $("#go-d").click(function() {
              loadEscalations();
       })

      $("#go-u").click(function() {
              loadEscalations();
       })

      /*$("#radio1").click(function() {
              loadEscalations();
       })

      $("#radio2").click(function() {
              loadEscalations();
       })

      $("#radio3").click(function() {
              loadEscalations();
       })

      $("#radio4").click(function() {
              loadEscalations();
       })*/


      $('#domainradio').click(function() {
             if( $(".textboxdomain").is(":hidden") ) {
               $(".textboxdomain").show();
               $("#domainradio").prop('checked', true);
             }
             else
             {
               $(".textboxdomain").hide();
               $("#domainradio").prop('checked', false);
             }
             });
      $('#countryradio').click(function() {
          if( $(".textboxcountry").is(":hidden") ) {
            $(".textboxcountry").show();
            $("#countryradio").prop('checked', true);
          }
          else
          {
            $(".textboxcountry").hide();
            $("#countryradio").prop('checked', false);
          }
      });


      $(".esc-tab").click(function() {
        $("#year-para").hide();        
        $(".esc-tab").addClass("active")
        //$(".actwise-tab").removeClass("active")
        $(".ageing-tab").removeClass("active")
        $(".compliance-tab").removeClass("active")
        $(".task-status-tab").removeClass("active");
        $(".trend-tab").removeClass("active")
        $(".usecom-tab").removeClass("active")
        $(".graph-box").show();
        $(".grid-table-dash").hide();
        $(".grid-table-dash1").hide();
        $("#level-filter").fadeIn();
        $("#viewaspie").hide();
        $("#unit-auto").show();
        $("#entity-auto").show();
        $("#division-auto").show();
        loadEscalations();
      })
    })


    function loadEscalationsBar(){
      $("#viewaspie").show();
      $("#viewasbar").hide();
      $("#back").hide();
      $(function () {
          var not_complied = 0;
          var drill="";
          var delayed= 0;
          var title = "";
          
              not_complied = 3;
              drill = "unitesc";
              delayed = 10;
              var dataSum = (10 + 3);
              title = "South gate, Madurai";
          
            $('#container').highcharts({
              colors:['#FF7700','#D10018'],
                chart: {
                    type: 'column'
                },
                title: {
                    text: 'Escalations - '+title
                },
                xAxis: {
                    type: 'category'
                },
                yAxis: {
                    title: {
                        text: 'Total tasks'
                    }

                },
                legend: {
                    enabled: false
                },
                plotOptions: {
                  column:{
                point: {
                        events: {
                            click: function() {
                                var drilldown = this.drilldown;
                                if (drilldown) {
                                 loadDrillDownData(drilldown); 
                                }
                            }
                          }
                        }
                },
                series: {
                        borderWidth: 0,
                    }
                },
                
                tooltip: {
                    headerFormat: '<span style="font-size:11px">{series.name}</span><br>',
                    pointFormat: '<span style="color:{point.color}">{point.name}</span>: <b>{point.y:.0f}</b> <br/>'
                },
                legend: {
                      reversed: true,
                      itemStyle: {
                          fontWeight:'normal',
                          fontSize:'11px'
                      }
                    },
        
        series: [{
                    name: "Tasks",
                    colorByPoint: true,
                     dataLabels: {
                            enabled: true,
                            format:'{point.percentage:.0f}%',
                            formatter:function() {
                                      var pcnt = (this.y / dataSum) * 100;
                                      return Highcharts.numberFormat(pcnt,0) + '%';
                            }
                        },
          data: [{
                        name: "Delayed compliance",
                        y:delayed,
                    }, {
                        name: "Not complied",
                        y:not_complied,
                        // drilldown:drill
                    }]
                }]        
            });
        });
    }

    function loadEscalations(){
      $("#viewasbar").hide();
      $("#viewaspie").hide();
      $("#previous").hide();
      $("#next").hide();
      $("#back").hide();
        $(function () {
            var ztt = 0;
            var drill="";
            var tts= 0;
            var chartColor = ['#FF9C80', '#F2746B', '#FB4739', '#DD070C'];
                        var stn= 0;
                  var above90= 0;
                  var title = "";
                  var total=0;
                  colors: chartColor;
                  drill = "unitesc";
                  var tts = 8;
                  var stn= 3;
                  var above90= 2;
                  var ztt = 5;
                  total = 8+3+2+5;
                  title = "Branch Office - 1 ";
                  total = 28;
              
              $('#container').highcharts({
                  // colors:['#a3d202','#e70808'], green, orange, yellow, red
                  colors: chartColor,
                  chart: {
                      type: 'pie',
                      options3d: {
                          enabled: true,
                          alpha: 30
                      }
                  },
                  title: {
                      text: 'Over due compliance of '+title
                  },
                  subtitle: {
                      text: ''
                  },
                  plotOptions: {
                      pie: {                          
                          depth: 45,
                          dataLabels: {
                              enabled: true,
                              format: '{point.percentage}%'
                          },
                          showInLegend: true,
                          point: {
                          events: {
                              click: function() {
                                  var drilldown = this.drilldown;
                                  if (drilldown) { 
                                    loadDrillDownData(drilldown);
                                  }
                              }
                            }
                        }
                      }
                  },
                  legend: {
                      reversed: true,
                      itemStyle: {
                          fontWeight:'normal',
                          fontSize:'11px'
                      }
                    },
                  tooltip: {
                    headerFormat: '',
                    pointFormat: '<span>{point.name}</span>: <b>{point.y:.0f}</b> out of '+total
                  },
                  series: [{
                      name: 'Compliances',
                       dataLabels: {
                            enabled: true,
                            format:'{point.percentage:.0f}%'
                        },
                      data: [
                          {
                            name:"0-30 days",
                            y:ztt,
                            // drilldown:drill
                          },{
                            name:"31-60 days",
                            y:tts,
                          },{
                            name:"61-90 days",
                            y:stn,
                          },{
                            name:"Above 90 days",
                            y:above90,
                          }             
                      ]
                  }]
              });
          });
    }


    function loadEscalationsBusinessGroup(){
      $("#viewasbar").hide();
      $("#viewaspie").hide();
      $("#previous").hide();
      $("#next").hide();
      $("#back").hide();
        $(function () {
            var ztt = 0;
            var drill="";
            var tts= 0;
            var chartColor = ['#FF9C80', '#F2746B', '#FB4739', '#DD070C'];
                        var stn= 0;
                  var above90= 0;
                  var title = "";
                  var total=0;
                  colors: chartColor;
                  drill = "unitesc";
                  var tts = 2;
                  var stn= 32;
                  var above90= 8;
                  var ztt =21;
                  total = 8+3+2+5;
                  title = "KG Business Group  ";
                  total = 28;
              
              $('#container').highcharts({
                  colors: chartColor,
                  chart: {
                      type: 'pie',
                      options3d: {
                          enabled: true,
                          alpha: 30
                      }
                  },
                  title: {
                      text: 'Over due compliance of '+title
                  },
                  subtitle: {
                      text: ''
                  },
                  plotOptions: {
                      pie: {                          
                          depth: 45,
                          dataLabels: {
                              enabled: true,
                              format: '{point.percentage}%'
                          },
                          showInLegend: true,
                          point: {
                          events: {
                              click: function() {
                                  var drilldown = this.drilldown;
                                  if (drilldown) { 
                                    loadDrillDownData(drilldown);
                                  }
                              }
                            }
                        }
                      }
                  },
                  legend: {
                      reversed: true,
                      itemStyle: {
                          fontWeight:'normal',
                          fontSize:'11px'
                      }
                    },
                  tooltip: {
                    headerFormat: '',
                    pointFormat: '<span>{point.name}</span>: <b>{point.y:.0f}</b> out of '+total
                  },
                  series: [{
                      name: 'Compliances',
                       dataLabels: {
                            enabled: true,
                            format:'{point.percentage:.0f}%'
                        },
                      data: [
                          {
                            name:"0-30 days",
                            y:ztt,
                          },{
                            name:"31-60 days",
                            y:tts,
                          },{
                            name:"61-90 days",
                            y:stn,
                          },{
                            name:"Above 90 days",
                            y:above90,
                          }             
                      ]
                  }]
              });
          });
    }


    function loadEscalationsLegalEntity(){
      $("#viewasbar").hide();
      $("#viewaspie").hide();
      $("#previous").hide();
      $("#next").hide();
      $("#back").hide();
        $(function () {
            var ztt = 0;
            var drill="";
            var tts= 0;
            var chartColor = ['#FF9C80', '#F2746B', '#FB4739', '#DD070C'];
                        var stn= 0;
                  var above90= 0;
                  var title = "";
                  var total=0;
                  colors: chartColor;
                  drill = "unitesc";
                  var tts = 30;
                  var stn= 22;
                  var above90= 19;
                  var ztt =21;
                  total = 4+9+2+9;
                  title = "KG";
                  total = 28;
              
              $('#container').highcharts({
                  colors: chartColor,
                  chart: {
                      type: 'pie',
                      options3d: {
                          enabled: true,
                          alpha: 30
                      }
                  },
                  title: {
                      text: 'Over due compliance of '+title
                  },
                  subtitle: {
                      text: ''
                  },
                  plotOptions: {
                      pie: {                          
                          depth: 45,
                          dataLabels: {
                              enabled: true,
                              format: '{point.percentage}%'
                          },
                          showInLegend: true,
                          point: {
                          events: {
                              click: function() {
                                  var drilldown = this.drilldown;
                                  if (drilldown) { 
                                    loadDrillDownData(drilldown);
                                  }
                              }
                            }
                        }
                      }
                  },
                  legend: {
                      reversed: true,
                      itemStyle: {
                          fontWeight:'normal',
                          fontSize:'11px'
                      }
                    },
                  tooltip: {
                    headerFormat: '',
                    pointFormat: '<span>{point.name}</span>: <b>{point.y:.0f}</b> out of '+total
                  },
                  series: [{
                      name: 'Compliances',
                       dataLabels: {
                            enabled: true,
                            format:'{point.percentage:.0f}%'
                        },
                      data: [
                          {
                            name:"0-30 days",
                            y:ztt,
                          },{
                            name:"31-60 days",
                            y:tts,
                          },{
                            name:"61-90 days",
                            y:stn,
                          },{
                            name:"Above 90 days",
                            y:above90,
                          }             
                      ]
                  }]
              });
          });
    }


  </script> 
{% endblock %}